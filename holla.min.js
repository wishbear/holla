!function(){function t(e,n,r){var i=t.resolve(e);if(null==i){r=r||e,n=n||"root";var o=new Error('Failed to require "'+r+'" from "'+n+'"');throw o.path=r,o.parent=n,o.require=!0,o}var s=t.modules[i];return s.exports||(s.exports={},s.client=s.component=!0,s.call(this,s.exports,t.relative(i),s)),s.exports}t.modules={},t.aliases={},t.resolve=function(e){"/"===e.charAt(0)&&(e=e.slice(1));for(var n=e+"/index.js",r=[e,e+".js",e+".json",e+"/index.js",e+"/index.json"],i=0;i<r.length;i++){var e=r[i];if(t.modules.hasOwnProperty(e))return e}return t.aliases.hasOwnProperty(n)?t.aliases[n]:void 0},t.normalize=function(t,e){var n=[];if("."!=e.charAt(0))return e;t=t.split("/"),e=e.split("/");for(var r=0;r<e.length;++r)".."==e[r]?t.pop():"."!=e[r]&&""!=e[r]&&n.push(e[r]);return t.concat(n).join("/")},t.register=function(e,n){t.modules[e]=n},t.alias=function(e,n){if(!t.modules.hasOwnProperty(e))throw new Error('Failed to alias "'+e+'", it does not exist');t.aliases[n]=e},t.relative=function(e){function n(t,e){for(var n=t.length;n--;)if(t[n]===e)return n;return-1}function r(n){var i=r.resolve(n);return t(i,e,n)}var i=t.normalize(e,"..");return r.resolve=function(r){var o=r.charAt(0);if("/"==o)return r.slice(1);if("."==o)return t.normalize(i,r);var s=e.split("/"),a=n(s,"deps")+1;return a||(a=0),r=s.slice(0,a+1).join("/")+"/deps/"+r},r.exists=function(e){return t.modules.hasOwnProperty(r.resolve(e))},r},t.register("component-indexof/index.js",function(t,e,n){var r=[].indexOf;n.exports=function(t,e){if(r)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}}),t.register("component-emitter/index.js",function(t,e,n){function r(t){return t?i(t):void 0}function i(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}var o=e("indexof");n.exports=r,r.prototype.on=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){r.off(t,n),e.apply(this,arguments)}var r=this;return this._callbacks=this._callbacks||{},e._off=n,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[t];if(!n)return this;if(1==arguments.length)return delete this._callbacks[t],this;var r=o(n,e._off||e);return~r&&n.splice(r,1),this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks[t];if(n){n=n.slice(0);for(var r=0,i=n.length;i>r;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}}),t.register("holla/dist/holla.js",function(t,e,n){!function(){var t,r,i,o;r=e("./Client"),t=e("./Call"),o=e("./shims"),i={createClient:function(t){return null==t&&(t={}),new r(t)},Call:t,Client:r,shims:o,supported:o.supported,config:o.PeerConnConfig,createStream:function(t,e){var n,r;return null==o.getUserMedia?e("Missing getUserMedia"):(n=e,r=function(t){return e(null,t)},o.getUserMedia(t,r,n),i)},createFullStream:function(t){return i.createStream({video:!0,audio:!0},t)},createVideoStream:function(t){return i.createStream({video:!0,audio:!1},t)},createAudioStream:function(t){return i.createStream({video:!1,audio:!0},t)}},n.exports=i}.call(this)}),t.register("holla/dist/Client.js",function(t,e,n){!function(){var t,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("emitter"),o=io,t=e("./Call"),r=function(e){function n(e){var n=this;this.options=null!=e?e:{},this.io=o.connect(this.options.host),this.io.on("reconnect",function(){return n.emit("reconnect")}),this.io.on("disconnect",function(){return n.emit("disconnect")}),this.io.on("error",function(t){return n.emit("error",t)}),this.io.on("callRequest",function(e){var r;return r=new t(n,e.id,e.caller),n.emit("call",r)})}return a(n,e),n.prototype.createCall=function(e){var n=this;return this.io.emit("createCall",function(r,i){var o;return null!=r?e(r):(o=new t(n,i),e(null,o))}),this},n.prototype.register=function(t,e){return this.io.emit("register",t,e)},n.prototype.unregister=function(t){return this.io.emit("unregister",t)},n}(i),n.exports=r}.call(this)}),t.register("holla/dist/Call.js",function(t,e,n){!function(){var t,r,i,o=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("./User"),r=e("emitter"),t=function(t){function e(t,e,n){var r=this;this.client=t,this.id=e,this._removeUser=o(this._removeUser,this),this._addNewUser=o(this._addNewUser,this),this._add=o(this._add,this),this._handleUserResponse=o(this._handleUserResponse,this),this.unmute=o(this.unmute,this),this.mute=o(this.mute,this),this.empty=o(this.empty,this),this.end=o(this.end,this),this.releaseLocalStream=o(this.releaseLocalStream,this),this.setLocalStream=o(this.setLocalStream,this),this.add=o(this.add,this),this.decline=o(this.decline,this),this.answer=o(this.answer,this),this._users={},n&&(this._add(n),this.caller=this.user(n)),this.client.io.on(""+this.id+":end",function(){return r.empty(),r.emit("end")}),this.client.io.on(""+this.id+":userAdded",this._addNewUser)}return a(e,t),e.prototype.answer=function(){return this.client.io.emit(""+this.id+":callResponse",!0),this.client.emit("callAnswered",this),this.caller.createConnection(),this.localStream&&this.caller.addLocalStream(this.localStream),this.caller.once("sdp",this.caller.sendAnswer),this},e.prototype.decline=function(){return this.client.io.emit(""+this.id+":callResponse",!1),this.client.emit("callDeclined",this),this},e.prototype.add=function(t){if(!this.localStream)throw new Error("Must call setLocalStream first");return this._add(t),this.client.io.emit("addUser",this.id,t,this._handleUserResponse(this.user(t))),this.user(t)},e.prototype.user=function(t){return this._users[t]},e.prototype.users=function(){return this._users},e.prototype.setLocalStream=function(t){return this.localStream=t,this},e.prototype.releaseLocalStream=function(){var t;return null!=(t=this.localStream)&&t.stop(),delete this.localStream,this},e.prototype.end=function(){var t=this;return this.client.io.emit("endCall",this.id,function(e){return null!=e?t.emit("error",e):void 0}),this},e.prototype.empty=function(){var t,e,n,r,i;for(i=this.users(),e=n=0,r=i.length;r>n;e=++n)t=i[e],this._removeUser(e);return this},e.prototype.mute=function(){var t,e,n,r;if(!this.localStream)throw new Error("Must call setLocalStream first");for(r=this.localStream.getAudioTracks(),e=0,n=r.length;n>e;e++)t=r[e],t.enabled=!1;return this},e.prototype.unmute=function(){var t,e,n,r;if(!this.localStream)throw new Error("Must call setLocalStream first");for(r=this.localStream.getAudioTracks(),e=0,n=r.length;n>e;e++)t=r[e],t.enabled=!0;return this},e.prototype._handleUserResponse=function(t){var e=this;return function(n){return null!=n?"Call declined"===n?(t.accepted=!1,t.emit("declined"),e.emit("userDeclined",t)):(t.emit("error",n),e.emit("error",n)):(t.accepted=!0,t.emit("answered"),e.emit("userAnswered",t)),e}},e.prototype._add=function(t){var e,n;return null==(n=(e=this._users)[t])&&(e[t]=new i(this,t)),this},e.prototype._addNewUser=function(t){var e;return this._add(t),e=this.user(t),e.createConnection(),e.addLocalStream(this.localStream),e.sendOffer(),this},e.prototype._removeUser=function(t){var e;return e=this.user(t),e.closeConnection(),delete this._users[t],this},e}(r),n.exports=t}.call(this)}),t.register("holla/dist/User.js",function(t,e,n){!function(){var t,r,i,o=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("./shims"),t=e("emitter"),r=function(t){function e(t,e){this.call=t,this.name=e,this._handleRemoteCandidate=o(this._handleRemoteCandidate,this),this._handleRemoteSDP=o(this._handleRemoteSDP,this),this._handleError=o(this._handleError,this),this.createConnection(),this.call.client.io.on(""+t.id+":"+e+":sdp",this._handleRemoteSDP),this.call.client.io.on(""+t.id+":"+e+":candidate",this._handleRemoteCandidate)}return a(e,t),e.prototype.connection=null,e.prototype.createConnection=function(){var t=this;return this.connection=new i.PeerConnection(i.PeerConnConfig,i.constraints),this.connection.onconnecting=function(){return t.emit("connecting")},this.connection.onopen=function(){return t.emit("connected")},this.connection.onicecandidate=function(e){return null!=(null!=e?e.candidate:void 0)?t.sendCandidate(e.candidate):void 0},this.connection.onaddstream=function(e){return t.addStream(e.stream)},this.connection.onremovestream=function(){return t.removeStream()},this},e.prototype.closeConnection=function(){return null==this.connection?this:(this.connection.close(),this.connection=null,this)},e.prototype.addLocalStream=function(t){return this.connection.addStream(t),this},e.prototype.addStream=function(t){return this._ready=!0,this.stream=t,this.emit("ready",this.stream),this},e.prototype.removeStream=function(){return this.end(),this},e.prototype.ready=function(t){return this._ready?t(this.stream):this.once("ready",t),this},e.prototype.sendCandidate=function(t){return this.call.client.io.emit("sendCandidate",this.call.id,this.name,t,this._handleError)},e.prototype.sendOffer=function(){var t,e,n=this;return t=function(t){return n.connection.setLocalDescription(t),t.sdp=i.processSDPOut(t.sdp),n.call.client.io.emit("sendSDPOffer",n.call.id,n.name,t,n._handleError)},e=function(t){return n.emit("error",t)},this.connection.createOffer(t,e,i.constraints),this},e.prototype.sendAnswer=function(){var t,e=this;return t=function(t){return t.sdp=i.processSDPOut(t.sdp),e.connection.setLocalDescription(t),e.call.client.io.emit("sendSDPAnswer",e.call.id,e.name,t,e._handleError)},this.connection.createAnswer(t,this._handleError,i.constraints),this},e.prototype._handleError=function(t){return null!=t?this.emit("error",t):void 0},e.prototype._handleRemoteSDP=function(t){var e,n=this;return t.sdp=i.processSDPIn(t.sdp),e=function(){return n.emit("sdp")},this.connection.setRemoteDescription(new i.SessionDescription(t),e,this._handleError),this},e.prototype._handleRemoteCandidate=function(t){return this.emit("candidate",t),this.connection.addIceCandidate(new i.IceCandidate(t)),this},e}(t),n.exports=r}.call(this)}),t.register("holla/dist/shims.js",function(t,e,n){!function(){var t,e,r,i,o,s,a,c,l,u,h,d,p,f,m,v;r=window.mozRTCPeerConnection||window.PeerConnection||window.webkitPeerConnection00||window.webkitRTCPeerConnection,t=window.mozRTCIceCandidate||window.RTCIceCandidate,i=window.mozRTCSessionDescription||window.RTCSessionDescription,e=window.MediaStream||window.webkitMediaStream,l=navigator.mozGetUserMedia||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia,o=window.URL||window.webkitURL||window.msURL||window.oURL,null!=l&&(l=l.bind(navigator)),a=navigator.mozGetUserMedia?"firefox":"chrome",m=null!=r&&null!=l,c=function(t,e){var n;return n=t.match(e),null!=n?n[1]:null},p=function(t,e){var n,r,i,o,s,a;for(r=t.split(" "),o=[],i=s=0,a=r.length;a>s;i=++s)n=r[i],3===i&&(o[i++]=e),n!==e&&(o[i++]=n);return o.join(" ")},d=function(t,e){var n,r,i,o,s,a,l;for(o=t[e].split(" "),r=a=0,l=t.length;l>a;r=++a)i=t[r],null!=i&&(s=c(i,/a=rtpmap:(\d+) CN\/\d+/i),null!=s&&(n=o.indexOf(s),-1!==n&&o.splice(n,1),t.splice(r,1)));return t[e]=o.join(" "),t},v=function(t){var e,n,r,i,o,s,a;if(r=t.split("\r\n"),i=function(){var t,i,o;for(o=[],e=t=0,i=r.length;i>t;e=++t)n=r[e],-1!==n.indexOf("m=audio")&&o.push(e);return o}()[0],null==i)return t;for(e=s=0,a=r.length;a>s;e=++s)if(n=r[e],-1!==n.indexOf("opus/48000")){o=c(n,/:(\d+) opus\/48000/i),null!=o&&(r[i]=p(r[i],o));break}return r=d(r,i),r.join("\r\n")},h=function(t){var e,n,r,i,o,s,c,l,u;if(r=[],"firefox"===a)for(e="a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:BAADBAADBAADBAADBAADBAADBAADBAADBAADBAAD",l=t.split("\r\n"),i=0,s=l.length;s>i;i++)n=l[i],r.push(n),0===n.indexOf("m=")&&r.push(e);else for(u=t.split("\r\n"),o=0,c=u.length;c>o;o++)n=u[o],-1===n.indexOf("a=ice-options:google-ice")&&r.push(n);return v(r.join("\r\n"))},u=function(t){return t},s=function(t,e){var n,r,i;if("string"==typeof e)return s(t,document.getElementById(e));if(e.jquery)for(e.attr("src",t),r=0,i=e.length;i>r;r++)n=e[r],n.play();else e.src=t,e.play();return e},f=function(){var n,c,d;if(m)return"firefox"===a?(n={iceServers:[{url:"stun:23.21.150.121"}]},c={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0,MozDontOfferDataChannel:!0}},e.prototype.getVideoTracks=function(){return[]},e.prototype.getAudioTracks=function(){return[]}):(n={iceServers:[{url:"stun:stun.l.google.com:19302"}]},c={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{DtlsSrtpKeyAgreement:!0}]},e.prototype.getVideoTracks||(e.prototype.getVideoTracks=function(){return this.videoTracks},e.prototype.getAudioTracks=function(){return this.audioTracks}),r.prototype.getLocalStreams||(r.prototype.getLocalStreams=function(){return this.localStreams},r.prototype.getRemoteStreams=function(){return this.remoteStreams})),e.prototype.pipe=function(t){var e;return e=o.createObjectURL(this),s(e,t),this},d={PeerConnection:r,IceCandidate:t,SessionDescription:i,MediaStream:e,getUserMedia:l,URL:o,attachStream:s,processSDPIn:u,processSDPOut:h,PeerConnConfig:n,browser:a,supported:m,constraints:c}},n.exports=f()}.call(this)}),t.alias("component-emitter/index.js","holla/deps/emitter/index.js"),t.alias("component-emitter/index.js","emitter/index.js"),t.alias("component-indexof/index.js","component-emitter/deps/indexof/index.js"),t.alias("holla/dist/holla.js","holla/index.js"),"object"==typeof exports?module.exports=t("holla"):"function"==typeof define&&define.amd?define(function(){return t("holla")}):this.holla=t("holla")}();
